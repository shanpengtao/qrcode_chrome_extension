!function(e){var o;"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?(o=window).onload=()=>{o.addEventListener("message",function(e){e=e.data;try{"checkIframeProtocol"===e.from&&o.gotoMeishi(e.targetType,e.targetId,!1,{triggerId:e.triggerId})}catch(e){console.log(e)}})}:o="undefined"!=typeof global?global:"undefined"!=typeof self?self:this,o.gotoMeishi=e())}(function(){return function t(i,r,a){function c(n,e){if(!r[n]){if(!i[n]){var o="function"==typeof require&&require;if(!e&&o)return o(n,!0);if(s)return s(n,!0);o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}o=r[n]={exports:{}};i[n][0].call(o.exports,function(e){var o=i[n][1][e];return c(o||e)},o,o.exports,t,i,r,a)}return r[n].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c}({1:[function(e,o,n){var t=0<=window.navigator.userAgent.indexOf("IM/v")||0<=window.navigator.userAgent.indexOf("Meishi/v");function d(e,o,n){return e.addEventListener?(e.addEventListener(o,n),{remove:function(){e.removeEventListener(o,n)}}):(e.attachEvent(o,n),{remove:function(){e.detachEvent(o,n)}})}function s(e,o){var n=document.createElement("iframe");return n.src=o,n.id="hiddenIframe",n.style.display="none",e.appendChild(n),n}function p(e,o,n){var t=setTimeout(function(){o(),r.remove()},1e3),i=(i=document.querySelector("#hiddenIframe"))||s(document.body,"about:blank"),r=d(window,"blur",function(){clearTimeout(t),r.remove(),n()});i.contentWindow.location.href=e}function l(e,o,n){var t,i,r;10===a()?function(e,o,n){var t=setTimeout(o,1e3);window.addEventListener("blur",function(){clearTimeout(t),n()});var i=document.querySelector("#hiddenIframe");i=i||s(document.body,"about:blank");try{i.contentWindow.location.href=e}catch(e){o(),clearTimeout(t)}}(e,o,n):9===a()||11===a()?p(e,o,n):(e=e,t=o,i=n,(r=window.open("","","width=0,height=0")).document.write("<iframe src='"+e+"'></iframe>"),setTimeout(function(){try{r.location.href,r.setTimeout("window.close()",1e3),i()}catch(e){r.close(),t()}},1e3))}function a(){var e,o=-1;return"Microsoft Internet Explorer"===navigator.appName?(e=navigator.userAgent,null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(o=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(e=navigator.userAgent,null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e)&&(o=parseFloat(RegExp.$1))),o}function i(e,o,n,t){function i(){o&&o()}function r(){n&&n()}var a,c;navigator.msLaunchUri?navigator.msLaunchUri(e,n,o):(c=(a=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),c=navigator.userAgent.toLowerCase(),{isOpera:a,isFirefox:"undefined"!=typeof InstallTrigger,isSafari:~c.indexOf("safari")&&!~c.indexOf("chrome")||0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,isChrome:!!window.chrome&&!a,isIE:!!document.documentMode,ua:c})).isFirefox?(64<=Number(c.ua.split("firefox/")[1].slice(0,2))?p:function(e,o,n){var t=(t=document.querySelector("#hiddenIframe"))||s(document.body,"about:blank");try{t.contentWindow.location.href=e,n()}catch(e){"NS_ERROR_UNKNOWN_PROTOCOL"==e.name&&o()}})(e,i,r):c.isChrome||c.isIOS?function(o,e,n,t){let i=1e3;-1<t.indexOf("chrome/")&&85<=Number(t.split("chrome/")[1].slice(0,2))&&Number(t.split("chrome/")[1].slice(0,2))<=88&&(i=3e3);for(var r=setTimeout(function(){e(),c.remove()},i),a=window;a!=a.parent;)a=a.parent;var c=d(a,"blur",function(){clearTimeout(r),c.remove(),n()});a.focus();try{window.location=o}catch(e){console.log(e),window.open(o)}}(e,i,r,c.ua):c.isIE?l(e,i,r):c.isSafari?p(e,i,r):t()}window.navigator&&navigator.serviceWorker&&t&&"docs.58corp.com"===window.location.host&&navigator.serviceWorker.getRegistrations().then(function(e){for(var o of e)o.unregister()}),o.exports=function(a,c,s=!1,o={}){if(-1<window.navigator.userAgent.indexOf("Electron")&&window.meishi&&window.meishi.quickPlay){var e;"person"==a?window.meishi.quickPlay({type:"openConversation",params:{userId:c,userType:"0"}}):"group"==a?window.meishi.quickPlay({type:"openConversation",params:{userId:c,userType:"1"}}):"app"==a?(e={appId:c,openType:o.openType||"",url:o.url||""},window.meishi.quickPlay({type:"openApp",params:e})):"sendMessageCard"==a&&(e=JSON.parse(c),window.meishi.relay(e))}else{let r={title:o.title||"正在为你打开美事",description:o.description||"没有安装美事？请点击去下载",confirmButtonColor:o.confirmButtonColor||"#1564ff"},e="meishiim:\\";a&&c&&(e=`meishiim:?${a}=${encodeURIComponent(c)}&triggerId=`+(encodeURIComponent(o.triggerId)||"")),"app"===a&&(e+=`&openType=${o.openType||""}&url=`+(encodeURIComponent(o.url)||"")),self==top&&window.frames.length==parent.frames.length?("videoApp"===a&&(e=o.url,r.title="正在为你打开美事视频会议",r.description="没有安装视频会议？请点击去下载"),i(e,function(){if(console.log("meishi protocol not recognized"),!(s||0<document.getElementsByClassName("meishiProtocolWrap").length)){document.body.style.position="relative";const o=document.createElement("div");o.className="meishiProtocolWrap",o.style.cssText="z-index: 9999; background-color: #fff; width: 448px; height: 188px; position: absolute; top: 5px; left: 50%; margin-left: -220px; padding: 32px 0px 0px 30px; border: 1px solid #d9d9d9; box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 15px 1px; font-family: 'PingFang SC'; display: block; border-radius: 6px;";const e=document.createElement("p");e.innerHTML=r.title,e.style.cssText="margin: 0px; font-size: 18px; line-height: 28px; color: #2C2E36;",o.appendChild(e);const n=document.createElement("p");n.innerHTML=r.description,n.style.cssText="margin:0px; font-size:14px; line-height:22px; color: #2C2E36;",o.appendChild(n);const t=document.createElement("div");t.innerHTML="去下载",t.style.cssText=`width: 98px; position: absolute; bottom: 32px; right: 32px; margin: 0px; font-size: 14px; line-height: 36px; text-align: center; color: rgb(255, 255, 255); background-color: ${r.confirmButtonColor}; border: 1px solid ${r.confirmButtonColor}; border-radius: 4px; cursor: pointer;`,d(t,"click",function(){let e=new URL("http://meishi.58.com/meishiProtocol");switch(a){case"app":e.searchParams.set("meishiAppId",c);break;case"person":e.searchParams.set("personId",c);break;case"group":e.searchParams.set("groupId",c);break;case"videoApp":e="https://meishi.58.com?downloadType=1"}window.open(e,"_blank"),document.body.removeChild(o)}),o.appendChild(t);const i=document.createElement("div");i.innerHTML="取消",i.style.cssText="width: 98px; position: absolute; bottom: 32px; right: 142px; margin: 0px; font-size: 14px; line-height: 36px; text-align: center; color: #2C2E36; background-color: rgb(255, 255, 255); border: 1px solid rgb(56 56 56 / 50%); border-radius: 4px; cursor: pointer;",d(i,"click",function(){document.body.removeChild(o)}),o.appendChild(i),document.body.appendChild(o)}},function(){console.log("meishi protocol recognized")})):(o={targetType:a,targetId:c,triggerId:o.triggerId||"",from:"checkIframeProtocol"},top.postMessage(o,"*"))}}},{}]},{},[1])(1)});